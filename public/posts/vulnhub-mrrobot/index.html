<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible"
      content="IE=edge">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0" />
<meta name="description"
      content="Adventures of Functional Mediocrity" />
<meta name="keywords"
      content="zola, theme, ink, hugo-ink" /> 

<title>John Tuyen | Mr. Robot</title>
<meta
  property="og:title"
  content="John Tuyen | Mr. Robot"
/>
<meta property="og:type" content="website" />
<meta property="og:url" content="https://johntuyen.com/posts/vulnhub-mrrobot/" />
<meta property="og:description" content="Adventures of Functional Mediocrity" />
<meta property="og:image" content="" />
<meta property="og:image:url" content="" />
<meta property="og:image:secure_url" content="" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Mr. Robot" />
<meta name="twitter:description" content="Adventures of Functional Mediocrity" />
<meta property="twitter:image" content="" />

<link rel="alternate"
          type="application/rss+xml"
          title="John Tuyen"
          href="https://johntuyen.com/atom.xml">
    <link rel="preconnect"
          href="https://fonts.googleapis.com">
    <link rel="preconnect"
          href="https://fonts.gstatic.com"
          crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">  -->
    <link href="https://fonts.googleapis.com/css2?family=Andada+Pro&display=swap&family=Playfair+Display"
          rel="stylesheet">
    <link rel="stylesheet"
          href="https://johntuyen.com/base.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"
            integrity="sha512-7x3zila4t2qNycrtZ31HO0NnJr8kg2VI67YLoRSyi9hGhRN66FHYWr7Axa9Y1J9tGYHVBPqIjSE1ogHrJTz51g=="
            crossorigin="anonymous"></script>
</head>

<body>
    <header>
        <a class="site-name"
           href="/">
            <h1>John Tuyen</h1>
        </a>
        <div class="site-description">
            <p>Adventures of Functional Mediocrity</p>
        </div>
        <nav>
            <div class="links"> 
            <a 
                href="https://johntuyen.com/ ">About</a> 
            <a 
                href="https://johntuyen.com/posts/ ">Posts</a> 
            <a 
                href="https://johntuyen.com/gallery/ ">Gallery</a> 
            <a 
                href="https://johntuyen.com/tags/ ">Tags</a> 
            <a 
                href="https://johntuyen.com/search/ ">Search</a> 
            </div>
        </nav>
    </header>
    <article>
    

<section class="post">
  <div class="post-header">
    <div class="meta">
      <div class="date">
        <span class="day">10</span>
        <span class="rest">May 19</span>
      </div>
    </div>

    <div class="matter">
      <h1 class="title">Mr. Robot </h1>
    </div>
  </div>
    
  <article><ol>
<li>
<p><code>Robots.txt</code> contained a dictionary file and 1/3 loot key. I'm guessing the dictionary file is used for bruteforcing the Wordpress login.</p>
</li>
<li>
<p>The dictionary file <code>fsocity.dic</code> contained 858000 entries and it's a lot to go through for brute force. Slim down the dictionary file for uniqueness showed 11400 entries which is way more efficient and quick to brute force with.</p>
<pre data-lang="shell" style="background-color:#2b303b;color:#c0c5ce;" class="language-shell "><code class="language-shell" data-lang="shell"><span>cat fsocity.dic | sort -u &gt; fsocity-sorted.dic
</span></code></pre>
</li>
<li>
<p>Now that we have the password sorted out, I've tried brute forcing using the generic <code>admin</code> username after trying to dig through the Wordpress pages for login information. After trying for couple of hours, clearly the username doesn't exist. To determine the username exist or not, using the reset password function showed provides positive or negative results. The machine name is Mr Robot so I figured it's based on the main character from the show &quot;elliot&quot;. Entering this username in the reset password form will show a positive result:</p>
<pre data-lang="shell" style="background-color:#2b303b;color:#c0c5ce;" class="language-shell "><code class="language-shell" data-lang="shell"><span>The e-mail could not be sent. Possible reason: your host may have disabled the mail() function.
</span></code></pre>
</li>
<li>
<p>Now that we have the username and password sorted out, time to brute force the Wordpress login page. Use <code>hydra</code> to brute force wordpress login.</p>
<pre data-lang="shell" style="background-color:#2b303b;color:#c0c5ce;" class="language-shell "><code class="language-shell" data-lang="shell"><span>hydra -l elliot -P fsocity-mod.dic 192.168.123.104 -V http-form-post &#39;/wp-login.php:log=^USER^&amp;pwd=^PASS^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&#39; -I
</span></code></pre>
<p><img src="https://johntuyen.com/posts/vulnhub-mrrobot/hydra.png" alt="hydra.png" /></p>
</li>
<li>
<p>Edit the Wordpress theme file <code>header.php</code>. Insert the php reverse shell code and save it.</p>
</li>
<li>
<p>Prepare netcat session to receive reverse shell.</p>
</li>
<li>
<p>Execute the reverse shell by navigating to <code>http://192.168.123.104/Image/</code></p>
</li>
<li>
<p>A low privilege shell should now be accessible. From here, running the linenum and linuxprivchecker scripts for later review. After digging around a bit to understand what's inside the system, /home/robot contains the 2/3 loot key. There is a file with an MD5 hash of <code>822c73956184f694993bede3eb39f959</code>. Crackstation.net showed the decrypted password for <code>robot</code> login as <code>abcdefghijklmnopqrstuvwxyz</code>.</p>
</li>
<li>
<p>Use <code>su</code> and login as <code>robot</code> login should now be accessible and 2/3 loot key is now readable.</p>
<p><img src="https://johntuyen.com/posts/vulnhub-mrrobot/loot-2.png" alt="loot-2.png" /></p>
</li>
<li>
<p>Upgrade the shell to interactive shell.</p>
<pre data-lang="shell" style="background-color:#2b303b;color:#c0c5ce;" class="language-shell "><code class="language-shell" data-lang="shell"><span>python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;
</span></code></pre>
</li>
<li>
<p>The linuxprivchecker script showed <code>nmap</code> with root permissions assigned along with sticky execution bit. This will allow us to exploit the nmap interactive shell to escalate our privileges as root.</p>
<pre data-lang="shell" style="background-color:#2b303b;color:#c0c5ce;" class="language-shell "><code class="language-shell" data-lang="shell"><span>-rwsr-xr-x 1 root root 504736 Nov 13  2015 /usr/local/bin/nmap
</span></code></pre>
<p><img src="https://johntuyen.com/posts/vulnhub-mrrobot/rooted.png" alt="rooted.png" /></p>
</li>
</ol>
</article>

  
    
  
  <ul class="tags">
    
      <li><a href='https://johntuyen.com/tags/vulnhub'>vulnhub</a></li>
    
  </ul>
  
  
    
</section>
</article>
    <footer>
        <div class="social">
            <ul> 
                 
                <li>
                    <a href="https://github.com/jtuyen"
                       title="Github" rel="me"><i data-feather="github"></i></a>
                </li>
                 
                 
                <li>
                    <a href="https://twitter.com/jtuyen"
                       title="Twitter"
                       rel="me"><i data-feather="twitter"></i></a>
                </li>
                
                
                
                <li>
                    <a href="https://johntuyen.com/atom.xml"
                       title="John Tuyen"><i data-feather="rss"></i></a>
                </li>
            </ul>
        </div>
        <p> Â© John Tuyen 2024

        
        <br>Powered by <a target="_blank" href="https://getzola.org/">Zola</a>. Theme: <a target="_blank" href="https://github.com/jimmyff/zola-inky">Inky</a>.
        </p>
    </footer>
    <script>
        feather.replace();
    </script> 
    </body>
</html>