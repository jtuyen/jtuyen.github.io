<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible"
      content="IE=edge">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0" />
<meta name="description"
      content="Adventures of Functional Mediocrity" />
<meta name="keywords"
      content="zola, theme, ink, hugo-ink" /> 

<title>John Tuyen | Traverxec</title>
<meta
  property="og:title"
  content="John Tuyen | Traverxec"
/>
<meta property="og:type" content="website" />
<meta property="og:url" content="https://johntuyen.com/posts/htb-traverxec/" />
<meta property="og:description" content="Adventures of Functional Mediocrity" />
<meta property="og:image" content="" />
<meta property="og:image:url" content="" />
<meta property="og:image:secure_url" content="" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Traverxec" />
<meta name="twitter:description" content="Adventures of Functional Mediocrity" />
<meta property="twitter:image" content="" />

<link rel="alternate"
          type="application/rss+xml"
          title="John Tuyen"
          href="https://johntuyen.com/atom.xml">
    <link rel="preconnect"
          href="https://fonts.googleapis.com">
    <link rel="preconnect"
          href="https://fonts.gstatic.com"
          crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">  -->
    <link href="https://fonts.googleapis.com/css2?family=Andada+Pro&display=swap&family=Playfair+Display"
          rel="stylesheet">
    <link rel="stylesheet"
          href="https://johntuyen.com/base.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"
            integrity="sha512-7x3zila4t2qNycrtZ31HO0NnJr8kg2VI67YLoRSyi9hGhRN66FHYWr7Axa9Y1J9tGYHVBPqIjSE1ogHrJTz51g=="
            crossorigin="anonymous"></script>
</head>

<body>
    <header>
        <a class="site-name"
           href="/">
            <h1>John Tuyen</h1>
        </a>
        <div class="site-description">
            <p>Adventures of Functional Mediocrity</p>
        </div>
        <nav>
            <div class="links"> 
            <a 
                href="https://johntuyen.com/ ">About</a> 
            <a 
                href="https://johntuyen.com/posts/ ">Posts</a> 
            <a 
                href="https://johntuyen.com/gallery/ ">Gallery</a> 
            <a 
                href="https://johntuyen.com/tags/ ">Tags</a> 
            <a 
                href="https://johntuyen.com/search/ ">Search</a> 
            </div>
        </nav>
    </header>
    <article>
    

<section class="post">
  <div class="post-header">
    <div class="meta">
      <div class="date">
        <span class="day">21</span>
        <span class="rest">Jun 19</span>
      </div>
    </div>

    <div class="matter">
      <h1 class="title">Traverxec </h1>
    </div>
  </div>
    
  <article><ol>
<li>
<p><code>nmap</code> scans show port 22 and 80 is opened. Port 80 displays a basic bootstrap template and nothing stands out in the source code when inspected. After checking out the <code>nmap</code> results in detail, I noticed the HTTP server header displays <code>nostromo 1.9.6</code>.</p>
</li>
<li>
<p>After researching what nostromo server is about, it's a lightweight http server. Searching for existing exploits show it's vulnerable to a <a href="https://www.exploit-db.com/exploits/47573">directory traversal remote code execution</a>.</p>
</li>
<li>
<p>Run Metasploit and execute the vulnerability. If you see nothing on your screen, wait a few seconds for a session to establish.</p>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-msf.png" alt="htb-traverxec-msf.png" /></p>
</li>
<li>
<p>Use <code>python</code> to create an interactive shell.</p>
<pre data-lang="python" style="background-color:#2b303b;color:#c0c5ce;" class="language-python "><code class="language-python" data-lang="python"><span>python -c &quot;</span><span style="color:#a3be8c;">import pty;pty.spawn(&#39;/bin/sh&#39;)</span><span>&quot;
</span></code></pre>
</li>
<li>
<p>After enumerating the machine using <code>linenum</code> and <code>linuxprivchecker</code> scripts, I found an <code>.htaccess</code> file hidden away at <code>/var/nostromo/conf/</code></p>
<p>The file contains an md5 hash for the user david: <code>$1$e7NfNpNi$A6nCwOTqrNR2oDuIKirRZ/</code></p>
</li>
<li>
<p>Cracking the hash using <code>hastcat</code> and rockyou wordlist.</p>
<p><code>hashcat -m 500 -a 0 -o output.txt hashes.txt rockyou.txt</code></p>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-hashcat.png" alt="htb-traverxec-hashcat.png" /></p>
<p>The password that was cracked is: Nowonly4me</p>
</li>
<li>
<p>Using the cracked credentials, I tried logging into SSH but no luck. I believe it probably uses an SSH key.</p>
</li>
<li>
<p>Enumerating the machine further, the <code>nhttpd.conf</code> file seems kind of odd, especially these lines:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span># HOMEDIRS [OPTIONAL]
</span><span>
</span><span>homedirs	/home
</span><span>homedirs_public		public_www
</span></code></pre>
<p>According to the <a href="https://www.gsp.com/cgi-bin/man.cgi?section=8&amp;topic=nhttpd">man page</a> of nostromo server, it mentions that the homedir is another way to access the user's home directory by using <code>~username</code> as part of the URL. When trying to navigate to this url: http://traverxec/~david, it leads to an image saying access denied.</p>
<p>Instead, I navigated to the user's home directory instead:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>/home/david/public_www/
</span></code></pre>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-protectedarea.png" alt="htb-traverxec-protectedarea.png" /></p>
<p>Nice and this explains why I got the image when navigating via URL. Time to investigate what is inside this directory. I have found a directory inside that contains a backup of SSH keys. This must be our way in using SSH.</p>
</li>
<li>
<p>First, I've tried using the private SSH key as is but it's protected by a password. I will need to convert the SSH key into a format that <code>john</code> can understand.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>/usr/share/john/ssh2john.py id_rsa &gt; id_rsa_john
</span></code></pre>
</li>
<li>
<p>Use <code>john</code> to crack the hash.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa_john --format=SSH
</span></code></pre>
<p>The cracked password is hunter.</p>
</li>
<li>
<p>Login using the SSH private key and obtain user flag.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>ssh -i id_rsa_john david@traverxec
</span></code></pre>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-userflag.png" alt="htb-traverxec-userflag.png" /></p>
</li>
<li>
<p>A quick enumeration shows a script located in David's home directory.</p>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-serverstats.png" alt="htb-traverxec-serverstats.png" /></p>
<p>This command seems interesting:</p>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-sudojournalctl.png" alt="htb-traverxec-sudojournalctl.png" /></p>
<p>Seeing how <code>sudo</code> is being used for the <code>journalctl</code> command, I'm wondering if there is a way to <a href="https://gtfobins.github.io/gtfobins/journalctl/">escalate my privilege</a>.</p>
<p>After playing around on how this command works, eventually I caught onto what the gtfobin's link mentioned:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>This invokes the default pager, which is likely to be **less**, other functions may apply.
</span></code></pre>
<p>When you run the command and minimize the window, it will trigger the <code>less</code> pager function.</p>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-halfwindow.png" alt="htb-traverxec-halfwindow.png" /></p>
<p>Thus, if a <code>less</code> pager function is triggered, you can escalate your privileges using <a href="https://gtfobins.github.io/gtfobins/less/">this method</a>. Root flag has been obtained.</p>
<p><img src="https://johntuyen.com/posts/htb-traverxec/htb-traverxec-rooted.png" alt="htb-traverxec-rooted.png" /></p>
</li>
</ol>
</article>

  
    
  
  <ul class="tags">
    
      <li><a href='https://johntuyen.com/tags/hackthebox'>hackthebox</a></li>
    
  </ul>
  
  
    
</section>
</article>
    <footer>
        <div class="social">
            <ul> 
                 
                <li>
                    <a href="https://github.com/jtuyen"
                       title="Github" rel="me"><i data-feather="github"></i></a>
                </li>
                 
                 
                <li>
                    <a href="https://twitter.com/jtuyen"
                       title="Twitter"
                       rel="me"><i data-feather="twitter"></i></a>
                </li>
                
                
                
                <li>
                    <a href="https://johntuyen.com/atom.xml"
                       title="John Tuyen"><i data-feather="rss"></i></a>
                </li>
            </ul>
        </div>
        <p> Â© John Tuyen 2024

        
        <br>Powered by <a target="_blank" href="https://getzola.org/">Zola</a>. Theme: <a target="_blank" href="https://github.com/jimmyff/zola-inky">Inky</a>.
        </p>
    </footer>
    <script>
        feather.replace();
    </script> 
    </body>
</html>